# 浏览器插件版桌面宠物 - 安装说明

## 简介

这是一个浏览器扩展版本的桌面宠物，可以在任何网页上显示可爱的宠物。

## 支持的浏览器

- Chrome 88+
- Edge 88+
- Brave
- Opera
- 其他基于 Chromium 的浏览器

## 安装方法

### 开发者模式安装

1. 打开浏览器扩展管理页面：
   - Chrome: `chrome://extensions/`
   - Edge: `edge://extensions/`
   - 或者通过菜单: 更多工具 → 扩展程序

2. 启用"开发者模式"（右上角开关）

3. 点击"加载已解压的扩展程序"

4. 选择本文件夹（包含 `manifest.json` 的目录）

5. 扩展安装完成！在工具栏可以看到扩展图标

### 打包为 .crx 文件

1. 在扩展管理页面，点击"打包扩展程序"

2. 选择扩展根目录

3. 生成 `.crx` 文件和 `.pem` 密钥文件

4. 可以分享 `.crx` 文件给其他用户安装

## 使用方法

### 基础使用

1. 点击扩展图标打开控制面板

2. 点击"启用宠物"按钮

3. 宠物会出现在当前网页上

4. 可以拖拽移动宠物位置

5. 点击宠物触发交互效果

### 控制面板功能

#### 基础控制
- **启用/禁用宠物**: 在当前页面显示或隐藏宠物
- **重置位置**: 将宠物移回左上角初始位置

#### 动画控制
- **待机**: 切换到待机动画
- **走路**: 触发走路动画
- **跳跃**: 触发跳跃动画
- **睡觉**: 触发睡眠动画

#### 设置
- **宠物大小**: 调整宠物显示大小（50%-200%）
- **移动速度**: 调整宠物移动动画速度（1-10）
- **自动动画间隔**: 设置自动切换动画的时间间隔（3-30 秒）

## 文件结构

```
extension/
├── manifest.json       # 扩展配置文件
├── popup.html          # 弹窗界面
├── popup.js            # 弹窗控制脚本
├── content.js          # 注入到网页的脚本
├── background.js       # 后台服务脚本
├── pet-style.css       # 宠物样式（可选）
├── icons/              # 图标文件夹
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md           # 本文件
```

## 权限说明

### 必需权限

- **storage**: 保存用户设置（宠物状态、大小、速度等）
- **activeTab**: 在当前标签页注入宠物
- **host_permissions (<all_urls>)**: 允许在所有网页上运行

### 数据隐私

本扩展：
- 不收集任何用户数据
- 不发送任何网络请求
- 所有设置仅存储在本地
- 不访问网页内容或用户输入

## 自定义开发

### 修改宠物外观

编辑 `content.js` 中的 HTML 和 CSS：

```javascript
petContainer.innerHTML = `
    <!-- 自定义 HTML -->
`;
```

### 添加新动画

在 `content.js` 的 `animations` 对象中添加：

```javascript
const animations = {
    custom: {
        duration: '2s',
        keyframes: '/* CSS 动画关键帧 */'
    }
};
```

在 `popup.html` 添加对应按钮：

```html
<button id="customAnim">自定义动画</button>
```

### 修改默认设置

编辑 `background.js` 中的初始化代码：

```javascript
chrome.storage.local.set({
    petEnabled: true,  // 默认启用
    size: 150,         // 默认大小
    speed: 7,          // 默认速度
    interval: 5        // 默认间隔（秒）
});
```

## 调试

### 查看日志

1. 打开扩展管理页面
2. 找到本扩展，点击"背景页"或"service worker"
3. 在开发者工具的 Console 中查看日志

### 调试内容脚本

1. 在目标网页上按 F12 打开开发者工具
2. 在 Console 中可以看到 content.js 的日志
3. 在 Sources 标签页可以调试脚本

### 调试弹窗

1. 右键点击扩展图标
2. 选择"检查弹出式窗口"
3. 开发者工具会打开，可以调试 popup.html 和 popup.js

## 常见问题

### 宠物不显示

1. 检查是否在控制面板中启用了宠物
2. 某些特殊页面（如 chrome:// 页面）无法注入脚本
3. 刷新页面后重试

### 拖拽不流畅

1. 检查网页是否有其他元素遮挡宠物
2. 降低宠物大小可能会改善性能
3. 某些复杂网页可能影响性能

### 设置没有保存

1. 检查浏览器是否允许扩展使用存储
2. 清除浏览器缓存后重试
3. 重新安装扩展

### 动画不播放

1. 检查 CSS 动画定义是否正确
2. 在开发者工具中查看是否有 CSS 冲突
3. 尝试禁用其他可能冲突的扩展

## 发布到应用商店

### Chrome Web Store

1. 注册 Chrome 开发者账号（需支付 $5 注册费）
2. 准备推广资料：
   - 128x128 图标
   - 至少 1 张截图（1280x800 或 640x400）
   - 详细描述
   - 宣传图片（可选）
3. 上传打包好的 .zip 文件
4. 填写商店列表信息
5. 提交审核（通常 1-3 天）

### Edge Add-ons

1. 注册 Microsoft Partner Center 账号
2. 准备类似的推广资料
3. 上传 .zip 文件
4. 提交审核

## 版本更新

更新扩展时：

1. 修改 `manifest.json` 中的版本号
2. 更新代码
3. 在扩展管理页面点击"重新加载"
4. 或重新打包分发

## 性能优化

- 使用 CSS3 动画代替 JavaScript 动画
- 避免频繁的 DOM 操作
- 使用 `requestAnimationFrame` 处理复杂动画
- 设置合理的自动动画间隔

## 安全建议

- 定期更新依赖项
- 不要在代码中硬编码敏感信息
- 遵循最小权限原则
- 验证所有用户输入

## 技术栈

- Manifest V3（最新标准）
- Vanilla JavaScript (ES6+)
- CSS3 Animations
- Chrome Storage API
- Chrome Tabs API
- Chrome Runtime API

## 支持与反馈

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- Email: [your-email]
- 扩展商店评论

## 许可证

MIT License

## 更新日志

### v1.0.0 (2024-XX-XX)
- 初始版本发布
- 基础拖拽和动画功能
- 控制面板
- 设置保存
